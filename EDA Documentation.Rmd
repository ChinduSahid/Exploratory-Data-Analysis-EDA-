---
title: "Exploratory Data Analysis"
author: "Chindu"
date: "5/26/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## This is a Expploratory Data Analysis report carried out on a sample CRM dataset


```{r,include= FALSE}
library(dplyr)
library(dlookr)
library(ggplot2)
```

Loading csv file into R studio
```{r}
data<-read.csv("ReadyforModelling.csv") 
```

Checking if R studio has identified the right structure for each variable
```{r}
str(data)
```
Changing structure of wrongly assigned variables and remove variables unrealated to the analysis
```{r}
data$Answered.by.specialist<- factor(data$Answered.by.specialist)
data$Booked.Status<- factor(data$Booked.Status)
data$EnquiryYear<-factor(data$EnquiryYear)
data$DepYear<-factor(data$DepYear)
data$X<-NULL
```
Get a better understanding of the entire dataset
```{r}
summary(data)
```
Get a better understanding of numeric/interger variables
```{r}
diagnose_numeric(data)
```
Get a better understanding of categorical variables
```{r}
diagnose_category(data)
```
Checking correlation between numerical variables
```{r}
plot_correlate(data)
```
Exploring relation between target varaible (Booked.Status) and a numeric variable
```{r}
categ<-target_by(data,Booked.Status)
cat_num<-relate(categ,Duration)
cat_num
summary(cat_num)
plot(cat_num) # relationship between booked.status and duration is represented using a desity plot
```
Exploring relation between target variable(BookedStatus) and a categorical variable
```{r}
cat_cat<-relate(categ,Allocated.Time)
cat_cat
plot(cat_cat) #mosaics plot
```

Understanding what is the most common numberof adults in each holiday type to carry out better marketing promotions.

```{r}
boxplot(data$Adults~data$Holiday.Type)
```


Desination by popularity and what is the total enquiries for each destination?
```{r}
pop_destination<- data %>% group_by(Destination) %>% count(Destination) %>%ungroup()

ggplot(data=pop_destination,aes(x=reorder(as.factor(Destination),n),y=n,fill=as.factor(Destination)))+geom_bar(stat="identity")+coord_flip()+
  labs(title= "most popular destination based on enquiries", x="Destination",y="Enquiries")
```
What are the day and month wise total enquiries?
```{r}
day_month_sale<- data%>%group_by(EnquiryMonth,EnquiryDay)  %>% count(Destination)%>%arrange(EnquiryMonth,EnquiryDay) %>% ungroup()

ggplot(data=day_month_sale, aes(x=EnquiryDay,y=n,fill=as.factor(EnquiryDay)))+geom_bar(stat="identity")+scale_x_continuous(breaks=seq(min(0),max(31),by=1))+facet_wrap(~EnquiryMonth,ncol=2)
```

Total enquiries by year and month
```{r}
year_month<- data%>%group_by(EnquiryYear,EnquiryMonth) %>% count(Destination)%>%arrange(EnquiryYear)%>%ungroup()
ggplot(data=year_month,aes(x=EnquiryYear,y=n,fill=as.factor(EnquiryMonth)))+ geom_bar(stat="identity")+
  labs(title="total enquiries per year-month",x="year",y="total enquiries",fill="EnquiryMonth")
```

How many enquiries were booked based on Allocated.Time
```{r}
data$Booked.Status<-as.integer(data$Booked.Status)
booked_Allocated<-data%>%group_by(Allocated.Time)%>% summarise(booked=sum(Booked.Status)) %>%arrange(Allocated.Time)%>%ungroup()
```

